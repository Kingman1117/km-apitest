{
  "caseId": "1150695810001062405",
  "name": "edupc正常提交答题，B端正常完成批阅",
  "group": "edupc_func",
  "needsLogin": "none",
  "steps": [
    {
      "action": "goto",
      "url": "http://huaedu1-110.365hjy.com.faidev.cc/exm.jsp?id=2856",
      "description": "访问考试页面"
    },
    {
      "action": "wait",
      "ms": 2000
    },
    {
      "action": "verify",
      "expect": "登录|进入考试|重新答题|考试",
      "snapshot": true,
      "description": "检查是否需要登录或可直接进入考试"
    },
    {
      "action": "evaluate",
      "script": "const loginIframe = document.querySelector('#J_memberLogin'); if(loginIframe) { const doc = loginIframe.contentDocument || loginIframe.contentWindow.document; const acct = doc.querySelector('input[name=\"memberAcct\"]'); const pwd = doc.querySelector('input[name=\"memberPswd\"]'); if(acct && pwd) { acct.focus(); acct.value='km7'; acct.dispatchEvent(new Event('input',{bubbles:true})); pwd.focus(); pwd.value='123456'; pwd.dispatchEvent(new Event('input',{bubbles:true})); const btn = doc.querySelector('button[type=\"submit\"]') || doc.querySelector('input[type=\"submit\"]'); if(btn) btn.click(); } }",
      "description": "如需登录，在iframe内填写km7/123456并提交"
    },
    {
      "action": "wait",
      "ms": 3000
    },
    {
      "action": "goto",
      "url": "http://huaedu1-110.365hjy.com.faidev.cc/exm.jsp?id=2856",
      "description": "重新访问考试页面（确保已登录）"
    },
    {
      "action": "wait",
      "ms": 2000
    },
    {
      "action": "click",
      "selector": "text=进入考试",
      "fallbacks": ["button:has-text('进入考试')", "a:has-text('进入考试')", "text=重新答题", "button:has-text('重新答题')", "a:has-text('重新答题')"],
      "description": "点击进入考试或重新答题"
    },
    {
      "action": "wait",
      "ms": 2000
    },
    {
      "action": "fill",
      "selector": "textarea",
      "value": "这是自动化测试提交的简答题答案，用于验证答题和批阅功能。",
      "fallbacks": ["textarea:first-of-type", ".answer-textarea", "input[type='text']"],
      "description": "简答题输入内容"
    },
    {
      "action": "wait",
      "ms": 1000
    },
    {
      "action": "evaluate",
      "script": "const options = document.querySelectorAll('.d_optionItem, .option-item, input[type=\"radio\"], input[type=\"checkbox\"]'); if(options.length > 0) { options[0].click(); }",
      "description": "选择第一个选项（选择题）"
    },
    {
      "action": "wait",
      "ms": 1000
    },
    {
      "action": "click",
      "selector": "text=提交",
      "fallbacks": ["button:has-text('提交')", "a:has-text('提交')", ".submit-btn"],
      "description": "点击提交答卷"
    },
    {
      "action": "wait",
      "ms": 1500
    },
    {
      "action": "click",
      "selector": "text=确认交卷",
      "fallbacks": ["button:has-text('确认交卷')", "text=确定", "button:has-text('确定')"],
      "description": "确认交卷"
    },
    {
      "action": "wait",
      "ms": 2000
    },
    {
      "action": "verify",
      "expect": "提交成功|交卷成功|成绩|得分|已提交",
      "snapshot": true,
      "description": "验证答卷提交成功"
    },
    {
      "action": "goto",
      "url": "http://i.edu.fkw.com.faidev.cc/?__aacct=huaedu1#/assistance/answer/listManager?eduTabs=1&eduChildTabs=0",
      "description": "访问后台批阅列表页"
    },
    {
      "action": "wait",
      "ms": 3000
    },
    {
      "action": "click",
      "selector": "text=查看",
      "fallbacks": ["a:has-text('查看')", "button:has-text('查看')", ".option-btn:has-text('查看')"],
      "description": "点击第一条数据的【查看】"
    },
    {
      "action": "wait",
      "ms": 2000
    },
    {
      "action": "evaluate",
      "script": "const spinbuttons = document.querySelectorAll('input[role=\"spinbutton\"], input[type=\"number\"]'); if(spinbuttons.length > 0) { const el = spinbuttons[0]; el.focus(); el.value = '0.2'; el.dispatchEvent(new Event('input', {bubbles:true})); el.dispatchEvent(new Event('change', {bubbles:true})); }",
      "description": "简答题打分0.2"
    },
    {
      "action": "wait",
      "ms": 500
    },
    {
      "action": "fill",
      "selector": "textarea",
      "value": "自动化测试点评内容",
      "fallbacks": ["textarea:first-of-type", "input[placeholder*='点评']"],
      "description": "输入点评内容"
    },
    {
      "action": "wait",
      "ms": 500
    },
    {
      "action": "click",
      "selector": "button:has-text('保存并发布')",
      "fallbacks": ["text=保存并发布", "button:has-text('保存')", ".save-btn"],
      "description": "点击【保存并发布】"
    },
    {
      "action": "wait",
      "ms": 2000
    },
    {
      "action": "verify",
      "expect": "成功|已发布|保存成功",
      "snapshot": true,
      "description": "验证批阅保存成功"
    },
    {
      "action": "goto",
      "url": "http://huaedu1-110.365hjy.com.faidev.cc/exm.jsp?id=2856",
      "description": "再次访问考试页面查看成绩"
    },
    {
      "action": "wait",
      "ms": 2000
    },
    {
      "action": "click",
      "selector": "text=查看成绩",
      "fallbacks": ["a:has-text('查看成绩')", "button:has-text('查看成绩')", "text=查看"],
      "description": "点击查看成绩"
    },
    {
      "action": "wait",
      "ms": 1500
    },
    {
      "action": "click",
      "selector": "text=展开答案及解析",
      "fallbacks": ["text=答案及解析", "text=展开", ".expand-btn", "a:has-text('展开')"],
      "description": "展开答案及解析"
    },
    {
      "action": "wait",
      "ms": 1500
    },
    {
      "action": "verify",
      "expect": "成绩|得分|答案|解析|0.2",
      "snapshot": true,
      "description": "验证成绩和答案解析正常展示"
    }
  ],
  "cleanup": null,
  "verify": "成绩|得分|答案|解析"
}
