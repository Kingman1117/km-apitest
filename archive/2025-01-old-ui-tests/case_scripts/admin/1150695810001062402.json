{
  "caseId": "1150695810001062402",
  "name": "管理后台正常添加表单",
  "group": "admin",
  "needsLogin": "admin",
  "steps": [
    {
      "action": "goto",
      "url": "http://i.edu.fkw.com.faidev.cc/?__aacct=huaedu1#/marketing/form"
    },
    {
      "action": "wait",
      "ms": 2000
    },
    {
      "action": "click",
      "selector": "button:has-text('添加表单')",
      "fallbacks": ["text=添加表单"],
      "description": "点击添加表单按钮"
    },
    {
      "action": "wait",
      "ms": 1500
    },
    {
      "action": "fill",
      "selector": "input[placeholder*='名称']",
      "value": "表单{timestamp}",
      "fallbacks": ["input[placeholder*='请输入名称']", "input[placeholder*='表单名称']", "input[placeholder*='请输入表单名称']"],
      "description": "输入表单名称"
    },
    {
      "action": "wait",
      "ms": 500
    },
    {
      "action": "click",
      "selector": "button:has-text('添加表单项')",
      "fallbacks": ["text=添加表单项", "button:has-text('添加项')"],
      "description": "点击添加表单项"
    },
    {
      "action": "wait",
      "ms": 1500
    },
    {
      "action": "evaluate",
      "script": "const dialogs = document.querySelectorAll('.el-dialog__wrapper'); for(const d of dialogs) { if(d.style.display !== 'none') { const input = d.querySelector('input[placeholder*=\"名称\"]') || d.querySelector('input[type=\"text\"]'); if(input) { input.focus(); input.value = '表单项名称'; input.dispatchEvent(new Event('input',{bubbles:true})); input.dispatchEvent(new Event('change',{bubbles:true})); break; } } }",
      "description": "输入表单项名称"
    },
    {
      "action": "wait",
      "ms": 500
    },
    {
      "action": "evaluate",
      "script": "const divs = document.querySelectorAll('div'); for(const div of divs) { if(div.textContent.trim() === '单行文本' && div.children.length === 0) { div.click(); break; } }",
      "description": "类型选择单行文本（div列表 filter hasText）"
    },
    {
      "action": "wait",
      "ms": 500
    },
    {
      "action": "evaluate",
      "script": "const dialogs = document.querySelectorAll('.el-dialog__wrapper'); for(const d of dialogs) { if(d.style.display !== 'none') { const btn = d.querySelector('.el-dialog__footer button.el-button--primary'); if(btn) { btn.click(); break; } } }",
      "description": "点击表单项弹窗确定按钮"
    },
    {
      "action": "wait",
      "ms": 1500
    },
    {
      "action": "click",
      "selector": "button:has-text('保存')",
      "fallbacks": ["button:has-text('保 存')", ".footer button.el-button--primary"],
      "force": true,
      "description": "点击最外层保存按钮"
    },
    {
      "action": "wait",
      "ms": 2000
    },
    {
      "action": "verify",
      "expect": "保存成功|操作成功|创建成功|表单",
      "snapshot": true,
      "description": "验证正常添加表单"
    }
  ],
  "cleanup": null,
  "verify": "保存成功|操作成功|创建成功"
}
