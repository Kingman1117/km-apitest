{
  "caseId": "1150695810001062399",
  "name": "管理后台正常新建作业",
  "group": "admin",
  "needsLogin": "admin",
  "steps": [
    {
      "action": "goto",
      "url": "http://i.edu.fkw.com.faidev.cc/?__aacct=huaedu1#/assistance/homework"
    },
    {
      "action": "wait",
      "ms": 2000
    },
    {
      "action": "click",
      "selector": "button:has-text('新建作业')",
      "fallbacks": ["text=新建作业", "button:has-text('新建')"],
      "description": "点击新建作业按钮"
    },
    {
      "action": "wait",
      "ms": 1500
    },
    {
      "action": "fill",
      "selector": "input[placeholder*='标题']",
      "value": "作业{timestamp}",
      "fallbacks": ["input[placeholder*='请输入标题']", "input[placeholder*='作业标题']", "input[placeholder*='名称']"],
      "description": "输入作业标题（不超20字符）"
    },
    {
      "action": "evaluate",
      "script": "const iframes = document.querySelectorAll('iframe'); for(const iframe of iframes) { try { const body = iframe.contentDocument.querySelector('body'); if(body && body.getAttribute('contenteditable') !== 'false') { body.innerHTML = '<p>请完成以下题目并提交</p>'; body.dispatchEvent(new Event('input', {bubbles:true})); break; } } catch(e) {} }",
      "description": "填写题干内容（UEditor iframe）"
    },
    {
      "action": "wait",
      "ms": 500
    },
    {
      "action": "evaluate",
      "script": "const textareas = document.querySelectorAll('textarea'); for(const ta of textareas) { if(ta.placeholder && (ta.placeholder.includes('参考答案') || ta.placeholder.includes('答案'))) { ta.focus(); ta.value = '参考答案内容示例'; ta.dispatchEvent(new Event('input', {bubbles:true})); ta.dispatchEvent(new Event('change', {bubbles:true})); break; } } if(textareas.length > 0 && !document.querySelector('textarea[placeholder*=\"答案\"]')) { const last = textareas[textareas.length - 1]; last.focus(); last.value = '参考答案内容示例'; last.dispatchEvent(new Event('input', {bubbles:true})); last.dispatchEvent(new Event('change', {bubbles:true})); }",
      "description": "填写参考答案"
    },
    {
      "action": "wait",
      "ms": 500
    },
    {
      "action": "click",
      "selector": "button:has-text('保存')",
      "fallbacks": ["button:has-text('保 存')", ".footer button.el-button--primary"],
      "force": true,
      "description": "点击保存按钮"
    },
    {
      "action": "wait",
      "ms": 2000
    },
    {
      "action": "verify",
      "expect": "保存成功|操作成功|创建成功|作业",
      "snapshot": true,
      "description": "验证正常新建作业"
    }
  ],
  "cleanup": null,
  "verify": "保存成功|操作成功|创建成功"
}
